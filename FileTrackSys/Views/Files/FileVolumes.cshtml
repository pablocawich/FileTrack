@model FileTracking.ViewModels.VolumesViewModel
@{
    ViewBag.Title = "FileVolume";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="row">
    <div class="col-lg-12">
        <h2>File Volume</h2>
        <p>You are viewing file num: @Model.File.FileNumber which belongs to @Model.File.FirstName @Model.File.MiddleName @Model.File.LastName</p>
    </div>
    <!-- /.col-lg-12 -->
</div>

<div class="row">
    <table id="registryVolumeTable" user-loc="@Model.AdUser.BranchesId" class="table  table-bordered table-hover">
        <thead>
        <tr class="row100 head">
            <th>File Number</th>
            <th>Volume</th>
            <th>Comment</th>
            <th>State</th>
            <th>Location Origin</th>
            <th>Current location</th>
            <th>Volume's Holder</th>
            <th>Action</th>
        </tr>
        </thead>
        <tbody>
        @foreach (var fileVol in Model.FileVolumes)
        {
            <tr>
                <td>@fileVol.File.FileNumber</td>
                <td>@fileVol.Volume</td>
                @if (fileVol.Comment == null)
                {
                    <td>Comment not provided</td>
                }
                else
                {
                    <td>@fileVol.Comment</td>
                }
                <td class="tdState">@fileVol.States.State</td>
                <td>@fileVol.Branches.Branch</td>
                <td class="currentLoc" currLoc-data="@fileVol.CurrentLocation"></td>
                @if (@fileVol.AdUserId == null)
                {
                    <td>At registry</td>
                }
                else
                {
                    <td>@fileVol.AdUser.Username</td>
                }
                <td class="tdBtn">
                    <button vol-data-id="@fileVol.Id" file-name="@Model.File.FirstName" class="btn btn-yahoo btn-sm js-edit-vol">
                        Update
                    </button>
                   
                </td>

            </tr>
        }
        </tbody>
    </table>
    <div class="modal fade" id="volumeEditModal" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static" data-keyboard="true">
        <div class="modal-dialog">
            <div class="modal-content" id="volEditModelContent">
            </div>
        </div>
    </div>
</div>
@section scripts
{
    <script>
        $(document).ready(function() {
           // var userLocId = $("#registryVolumeTable").attr("user-loc");
            // alert(userLocation);
            $("#registryVolumeTable").on("click",
                ".js-edit-vol",
                function() {
                    var volId = $(this).attr("vol-data-id");
                    bootbox.confirm("Are you sure you want to edit this file?",
                        function(result) {
                            if (result) {
                                var url = "/FileVolumes/UpdateVolumeDescription/" + volId;
                                // alert(url);
                                $('#volEditModelContent').load(url);
                                $('#volumeEditModal').modal('show');
                            }
                        });
                 
                });

            //inserting a string value for current location

            $(".currentLoc").each(function() {
                var locNum = $(this).attr("currLoc-data");
                var num = parseInt(locNum);
                switch (num) {
                case 1:
                    $(this).text("Corozal");
                    break;
                case 2:
                    $(this).text("Orange Walk");
                    break;
                case 3:
                    $(this).text("Belize City");
                    break;
                case 4:
                    $(this).text("San Pedro");
                    break;
                case 5:
                    $(this).text("Belmopan");
                    break;
                case 6:
                    $(this).text("Dangriga");
                    break;
                }
            });
        });
    </script>
}
